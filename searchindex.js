Search.setIndex({"docnames": ["docstrings", "index", "writing"], "filenames": ["docstrings.rst", "index.rst", "writing.rst"], "titles": ["cyvcf2 API", "cyvcf2", "Modifying Existing VCFs"], "terms": {"i": [0, 1, 2], "fast": [1, 2], "vcf": [0, 1], "parser": 1, "python": 1, "2": [0, 1], "3": [0, 1], "releas": 1, "under": 1, "mit": 1, "licens": 1, "It": [0, 1], "cython": 1, "wrapper": 1, "htslib": 1, "develop": 1, "quinlan": 1, "lab": 1, "api": 1, "detail": 1, "document": 1, "most": 1, "common": 1, "usag": 1, "summar": 1, "snippet": 1, "below": [1, 2], "from": [0, 1, 2], "import": [1, 2], "variant": [0, 1, 2], "some": [1, 2], "gz": [0, 1], "bcf": [0, 1], "ref": [0, 1], "alt": [0, 1], "e": [0, 1], "g": [0, 1], "A": 1, "c": 1, "t": [0, 1], "chrom": [0, 1], "start": [0, 1], "end": [0, 1], "id": [0, 1, 2], "filter": [0, 1, 2], "qual": [0, 1], "numpi": [0, 1, 2], "arrai": [0, 1, 2], "specif": 1, "thing": 1, "we": [1, 2], "pull": [0, 1], "sampl": [0, 1, 2], "field": [0, 1], "gt_type": [0, 1], "0": [0, 1], "1": [0, 1, 2], "hom_ref": [0, 1], "het": [0, 1], "unknown": [0, 1], "hom_alt": [0, 1], "gt_ref_depth": [0, 1], "gt_alt_depth": [0, 1], "gt_phase": [0, 1], "gt_qual": [0, 1], "gt_base": [0, 1], "info": [0, 1], "extract": [0, 1, 2], "": 1, "name": [0, 1], "get": [0, 1], "dp": 1, "int": [0, 1], "f": 1, "float": [0, 1], "ac": 1, "convert": 1, "back": 1, "string": [0, 1, 2], "str": [0, 1], "per": 1, "depth": [0, 1], "format": [0, 1], "ani": [0, 1, 2], "other": 1, "sb": 1, "assert": 1, "shape": [0, 1], "n_sampl": [0, 1], "4": [0, 1], "valu": [0, 1], "do": 1, "region": 1, "queri": [0, 1], "v": [0, 1, 2], "11": 1, "435345": 1, "556565": 1, "af": 1, "continu": 1, "print": 1, "singl": [0, 1], "becom": 1, "true": [0, 1], "would": 1, "fals": [0, 1, 2], "optim": [1, 2], "read": [0, 1, 2], "file": [0, 1, 2], "howev": [1, 2], "offer": [1, 2], "mean": [1, 2], "here": [1, 2], "show": [1, 2], "an": [0, 1, 2], "exampl": [1, 2], "how": [1, 2], "locu": [1, 2], "annot": [1, 2], "gene": [1, 2], "thei": [1, 2], "overlap": [1, 2], "writer": [0, 1, 2], "vcf_path": [1, 2], "adjust": [1, 2], "header": [0, 1, 2], "contain": [0, 1, 2], "new": [0, 1, 2], "kei": [0, 1, 2], "descript": [0, 1, 2], "type": [0, 1, 2], "number": [0, 1, 2], "ar": [0, 1, 2], "requir": [1, 2], "add_info_to_head": [0, 1, 2], "charact": [1, 2], "creat": [0, 1, 2], "us": [0, 1, 2], "input": [1, 2], "templat": [0, 1, 2], "fname": [0, 1, 2], "out": [1, 2], "w": [0, 1, 2], "The": [0, 1, 2], "get_gene_intersect": [1, 2], "function": [0, 1, 2], "shown": [1, 2], "thi": [0, 1, 2], "could": [1, 2], "oper": [1, 2], "find": [1, 2], "intersect": [1, 2], "manipul": [1, 2], "user": [1, 2], "none": [0, 1, 2], "join": [1, 2], "write_record": [0, 1, 2], "close": [0, 1, 2], "more": 1, "write": [0, 1], "can": [0, 1], "found": 1, "By": 1, "default": [0, 1], "miss": 1, "allel": [0, 1], "classifi": [0, 1], "heterozyg": [0, 1], "instead": 1, "case": 1, "made": 1, "either": 1, "classif": 1, "partial": 1, "depend": 1, "situat": 1, "better": 1, "wai": 1, "explicitli": [0, 1], "control": 1, "strict_gt": [0, 1], "featur": 1, "path": [0, 1], "someth": 1, "when": 1, "flag": 1, "enabl": 1, "treat": 1, "otherwis": 1, "like": [0, 1, 2], "preserv": 1, "backward": 1, "compat": 1, "pip": 1, "via": 1, "bioconda": 1, "pytest": 1, "run": 1, "current": [1, 2], "doe": [1, 2], "support": [1, 2], "encod": [1, 2], "utf": [1, 2], "8": [0, 1, 2], "non": [1, 2], "ascii": [0, 1, 2], "content": [1, 2], "For": [0, 1], "pysam": 1, "ha": [0, 1], "one": [0, 1], "block": 1, "code": [1, 2], "taken": 1, "directli": 1, "librari": 1, "But": 1, "want": [0, 1], "gemini": 1, "veri": 1, "so": [1, 2], "have": 1, "chosen": 1, "separ": 1, "project": 1, "cyvcf2": 2, "also": [0, 2], "where": [0, 2], "call": [0, 2], "record": [0, 2], "demonstr": 2, "add": [0, 2], "add_format_to_head": [0, 2], "filter_cod": 2, "numer": 2, "reason": 2, "integ": [0, 2], "filter_sampl": 2, "sinc": 2, "specifi": [0, 2], "must": [0, 2], "n": 2, "x": 2, "indici": 2, "dictionari": [0, 2], "set_format": [0, 2], "index": 2, "overwrit": 2, "each": [0, 2], "nocal": 2, "note": 2, "until": [0, 2], "reassign": 2, "leav": 2, "object": [0, 2], "inconsist": 2, "state": 2, "ploidi": [0, 2], "necessari": 2, "reprocess": 2, "futur": 2, "properli": 2, "reflect": 2, "chang": 2, "class": 0, "mode": 0, "r": 0, "gts012": 0, "lazi": 0, "thread": 0, "hold": 0, "method": 0, "iter": 0, "over": 0, "paramet": 0, "bool": 0, "If": 0, "flip": 0, "don": 0, "unpack": 0, "pars": 0, "underli": 0, "need": 0, "present": 0, "genotyp": 0, "correspond": 0, "element": 0, "list": 0, "full": 0, "set": 0, "includ": 0, "reader": 0, "return": 0, "add_filter_to_head": 0, "self": 0, "adict": 0, "line": 0, "dict": 0, "add_to_head": 0, "check": 0, "given": 0, "gen_vari": 0, "site": 0, "offset": 0, "call_rat": 0, "get_header_typ": 0, "order": 0, "bcf_hl_info": 0, "bcf_hl_fmt": 0, "rec": 0, "inform": 0, "header_it": 0, "raw_head": 0, "raw": 0, "related": 0, "n_variant": 0, "35000": 0, "gap": 0, "30000": 0, "min_af": 0, "04": 0, "max_af": 0, "linkage_max": 0, "min_depth": 0, "seqlen": 0, "chromosom": 0, "length": 0, "defin": 0, "seqnam": 0, "set_index": 0, "index_path": 0, "set_sampl": 0, "befor": 0, "arg": 0, "kwarg": 0, "repres": 0, "intern": 0, "provid": 0, "access": 0, "po": 0, "base": 0, "altern": 0, "pass": 0, "give": 0, "empti": 0, "properti": 0, "refer": 0, "aaf": 0, "frequenc": 0, "across": 0, "proport": 0, "were": 0, "sv": 0, "vtype": 0, "request": 0, "match": 0, "indic": 0, "phase": 0, "while": 0, "count": 0, "gt_alt_freq": 0, "freq": 0, "gt_depth": 0, "boolean": 0, "whether": 0, "gt_phred_ll_het": 0, "pl": 0, "gt_phred_ll_homalt": 0, "gt_phred_ll_homref": 0, "hom": 0, "gq": 0, "is_delet": 0, "delet": 0, "is_indel": 0, "indel": 0, "is_mnp": 0, "mnp": 0, "is_snp": 0, "snp": 0, "is_sv": 0, "is_transit": 0, "transit": 0, "num_cal": 0, "num_het": 0, "num_hom_alt": 0, "homozyg": 0, "num_hom_ref": 0, "num_unknown": 0, "ndarrai": 0, "data": 0, "fix": 0, "np": 0, "bytes_": 0, "set_po": 0, "pos0": 0, "posit": 0, "var_typ": 0, "tmpl": 0, "make": 0, "output": 0, "infer": 0, "filenam": 0, "extens": 0, "stdout": 0, "left": 0, "uncompress": 0, "produc": 0, "valid": 0, "wbu": 0, "wb": 0, "compress": 0, "wz": 0, "level": 0, "ad": 0, "wz4": 0, "both": 0, "you": 0, "appropri": 0, "from_str": 0, "cl": 0, "header_str": 0, "u": 0, "byte": 0, "variant_from_str": 0, "variant_str": 0, "write_head": 0, "var": 0, "act": 0, "expect": 0, "accord": 0, "what": 0, "item": 0, "del": 0}, "objects": {"cyvcf2.cyvcf2": [[0, 0, 1, "", "INFO"], [0, 0, 1, "", "VCF"], [0, 0, 1, "", "Variant"], [0, 0, 1, "", "Writer"]], "cyvcf2.cyvcf2.VCF": [[0, 1, 1, "", "add_filter_to_header"], [0, 1, 1, "", "add_format_to_header"], [0, 1, 1, "", "add_info_to_header"], [0, 1, 1, "", "add_to_header"], [0, 1, 1, "", "contains"], [0, 1, 1, "", "gen_variants"], [0, 1, 1, "", "get_header_type"], [0, 1, 1, "", "header_iter"], [0, 2, 1, "", "raw_header"], [0, 1, 1, "", "relatedness"], [0, 2, 1, "", "samples"], [0, 2, 1, "", "seqlens"], [0, 2, 1, "", "seqnames"], [0, 1, 1, "", "set_index"], [0, 1, 1, "", "set_samples"]], "cyvcf2.cyvcf2.Variant": [[0, 2, 1, "", "ALT"], [0, 2, 1, "", "CHROM"], [0, 2, 1, "", "FILTER"], [0, 2, 1, "", "FILTERS"], [0, 2, 1, "", "FORMAT"], [0, 2, 1, "", "ID"], [0, 2, 1, "", "INFO"], [0, 2, 1, "", "POS"], [0, 2, 1, "", "QUAL"], [0, 2, 1, "", "REF"], [0, 2, 1, "", "aaf"], [0, 2, 1, "", "call_rate"], [0, 2, 1, "", "end"], [0, 1, 1, "", "format"], [0, 2, 1, "", "genotypes"], [0, 2, 1, "", "gt_alt_depths"], [0, 2, 1, "", "gt_alt_freqs"], [0, 2, 1, "", "gt_bases"], [0, 2, 1, "", "gt_depths"], [0, 2, 1, "", "gt_phases"], [0, 2, 1, "", "gt_phred_ll_het"], [0, 2, 1, "", "gt_phred_ll_homalt"], [0, 2, 1, "", "gt_phred_ll_homref"], [0, 2, 1, "", "gt_quals"], [0, 2, 1, "", "gt_ref_depths"], [0, 2, 1, "", "gt_types"], [0, 2, 1, "", "is_deletion"], [0, 2, 1, "", "is_indel"], [0, 2, 1, "", "is_mnp"], [0, 2, 1, "", "is_snp"], [0, 2, 1, "", "is_sv"], [0, 2, 1, "", "is_transition"], [0, 2, 1, "", "num_called"], [0, 2, 1, "", "num_het"], [0, 2, 1, "", "num_hom_alt"], [0, 2, 1, "", "num_hom_ref"], [0, 2, 1, "", "num_unknown"], [0, 2, 1, "", "ploidy"], [0, 1, 1, "", "set_format"], [0, 1, 1, "", "set_pos"], [0, 2, 1, "", "start"], [0, 2, 1, "", "var_type"]], "cyvcf2.cyvcf2.Writer": [[0, 1, 1, "", "close"], [0, 1, 1, "", "from_string"], [0, 2, 1, "", "name"], [0, 1, 1, "", "variant_from_string"], [0, 1, 1, "", "write_header"], [0, 1, 1, "", "write_record"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "attribute", "Python attribute"]}, "titleterms": {"cyvcf2": [0, 1], "api": 0, "modifi": [1, 2], "exist": [1, 2], "record": 1, "set": 1, "genotyp": [1, 2], "strict": 1, "instal": 1, "test": 1, "known": [1, 2], "limit": [1, 2], "see": 1, "also": 1, "vcf": 2, "info": 2, "field": 2, "format": 2, "write": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"cyvcf2": [[1, "cyvcf2"]], "Modifying Existing Records": [[1, "modifying-existing-records"]], "Setting Genotyping Strictness": [[1, "setting-genotyping-strictness"]], "Installation": [[1, "installation"]], "Testing": [[1, "testing"]], "Known Limitations": [[1, "known-limitations"]], "See Also": [[1, "see-also"]], "Modifying Existing VCFs": [[2, "modifying-existing-vcfs"]], "Modifying the INFO field": [[2, "modifying-the-info-field"]], "Modifying genotypes and the FORMAT field": [[2, "modifying-genotypes-and-the-format-field"]], "Known Limitations with Writing VCFs": [[2, "known-limitations-with-writing-vcfs"]], "cyvcf2 API": [[0, "cyvcf2-api"]]}, "indexentries": {"alt (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.ALT"]], "chrom (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.CHROM"]], "filter (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.FILTER"]], "filters (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.FILTERS"]], "format (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.FORMAT"]], "id (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.ID"]], "info (class in cyvcf2.cyvcf2)": [[0, "cyvcf2.cyvcf2.INFO"]], "info (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.INFO"]], "pos (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.POS"]], "qual (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.QUAL"]], "ref (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.REF"]], "vcf (class in cyvcf2.cyvcf2)": [[0, "cyvcf2.cyvcf2.VCF"]], "variant (class in cyvcf2.cyvcf2)": [[0, "cyvcf2.cyvcf2.Variant"]], "writer (class in cyvcf2.cyvcf2)": [[0, "cyvcf2.cyvcf2.Writer"]], "aaf (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.aaf"]], "add_filter_to_header() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.add_filter_to_header"]], "add_format_to_header() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.add_format_to_header"]], "add_info_to_header() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.add_info_to_header"]], "add_to_header() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.add_to_header"]], "call_rate (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.call_rate"]], "close() (cyvcf2.cyvcf2.writer method)": [[0, "cyvcf2.cyvcf2.Writer.close"]], "contains() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.contains"]], "end (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.end"]], "format() (cyvcf2.cyvcf2.variant method)": [[0, "cyvcf2.cyvcf2.Variant.format"]], "from_string() (cyvcf2.cyvcf2.writer method)": [[0, "cyvcf2.cyvcf2.Writer.from_string"]], "gen_variants() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.gen_variants"]], "genotypes (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.genotypes"]], "get_header_type() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.get_header_type"]], "gt_alt_depths (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_alt_depths"]], "gt_alt_freqs (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_alt_freqs"]], "gt_bases (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_bases"]], "gt_depths (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_depths"]], "gt_phases (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_phases"]], "gt_phred_ll_het (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_phred_ll_het"]], "gt_phred_ll_homalt (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_phred_ll_homalt"]], "gt_phred_ll_homref (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_phred_ll_homref"]], "gt_quals (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_quals"]], "gt_ref_depths (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_ref_depths"]], "gt_types (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.gt_types"]], "header_iter() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.header_iter"]], "is_deletion (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_deletion"]], "is_indel (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_indel"]], "is_mnp (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_mnp"]], "is_snp (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_snp"]], "is_sv (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_sv"]], "is_transition (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.is_transition"]], "name (cyvcf2.cyvcf2.writer attribute)": [[0, "cyvcf2.cyvcf2.Writer.name"]], "num_called (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.num_called"]], "num_het (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.num_het"]], "num_hom_alt (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.num_hom_alt"]], "num_hom_ref (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.num_hom_ref"]], "num_unknown (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.num_unknown"]], "ploidy (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.ploidy"]], "raw_header (cyvcf2.cyvcf2.vcf attribute)": [[0, "cyvcf2.cyvcf2.VCF.raw_header"]], "relatedness() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.relatedness"]], "samples (cyvcf2.cyvcf2.vcf attribute)": [[0, "cyvcf2.cyvcf2.VCF.samples"]], "seqlens (cyvcf2.cyvcf2.vcf attribute)": [[0, "cyvcf2.cyvcf2.VCF.seqlens"]], "seqnames (cyvcf2.cyvcf2.vcf attribute)": [[0, "cyvcf2.cyvcf2.VCF.seqnames"]], "set_format() (cyvcf2.cyvcf2.variant method)": [[0, "cyvcf2.cyvcf2.Variant.set_format"]], "set_index() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.set_index"]], "set_pos() (cyvcf2.cyvcf2.variant method)": [[0, "cyvcf2.cyvcf2.Variant.set_pos"]], "set_samples() (cyvcf2.cyvcf2.vcf method)": [[0, "cyvcf2.cyvcf2.VCF.set_samples"]], "start (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.start"]], "var_type (cyvcf2.cyvcf2.variant attribute)": [[0, "cyvcf2.cyvcf2.Variant.var_type"]], "variant_from_string() (cyvcf2.cyvcf2.writer method)": [[0, "cyvcf2.cyvcf2.Writer.variant_from_string"]], "write_header() (cyvcf2.cyvcf2.writer method)": [[0, "cyvcf2.cyvcf2.Writer.write_header"]], "write_record() (cyvcf2.cyvcf2.writer method)": [[0, "cyvcf2.cyvcf2.Writer.write_record"]]}})